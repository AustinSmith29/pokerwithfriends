<!DOCTYPE html>
<html>
    <head>
        <script src="scripts/socket.io/socket.io.js"></script>
        <script src="scripts/phaser/phaser.min.js"></script>
    </head>
    <body>
        <div id="game"></div>
        <script>
            var config = {
                type: Phaser.AUTO,
                scale: {
                    parent: 'game',
                    autoCenter: Phaser.Scale.CENTER_BOTH,
                    width: window.innerWidth * window.devicePixelRatio, 
                    height: window.innerHeight * window.devicePixelRatio
                }, 
                scene: {
                    preload: preload,
                    create: create,
                    update: update
                }
            };

            var game = new Phaser.Game(config);
            var table;
            var scaleRatio = window.devicePixelRatio / 3;

            function preload() {
                table = this.load.image('table', 'assets/pokertable.png');
            }

            function create() {
                this.add.image(400, 300, 'table');
                table.scale.setTo(scaleRatio, scaleRatio);
            }

            function update() {
            } 
        </script>
        <script>
            var socket = io('/game');
            let params = new URLSearchParams(location.search);
            const roomName = params.get('roomName');
            const state = {};
            socket.emit('JOIN', {roomName: roomName});

            socket.on('TABLESYNC', function(gameState) {
                state = {...gameState};
            });

            socket.on('SIT_REQUEST', function(request) {
                console.log('Recieved sit request.');
            });

            socket.on('SIT_ACCEPT', function() {
                console.log('You are seated!');
            });

            function sit(seat) {
                console.log('Sending message');
                socket.emit('SIT', {roomName: roomName, seat: seat});
            }

            </script>
    </body>
</html>
